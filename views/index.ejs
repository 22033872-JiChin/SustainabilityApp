<%- include ('partials/navbar.ejs') %>

<div class="container">
  <div class="row">
    <div class="col-12">
      <div class="text-center mb-4">
        <h2>Sustainability Goals</h2>
      </div>
    </div>
  </div>
  
  <div class="row">
    <div class="col-12">
      <table class="table table-hover small text-center">
        <thead class="table-dark">
          <tr>
            <th width="50">Goal</th>
            <th width="300">Goal Description</th>
            <th width="150">Carbon Footprint</th>
            <th width="150">Start Date</th>
            <th width="150">End Date</th>
            <th width="150">Status</th>
            <th width="50">Edit</th>
            <th width="50">Delete</th>
          </tr>
        </thead>
        <tbody>
          <% for(let i=0; i < goals.length; i++) { %>
            <tr>
              <td><a href="/goal/<%= goals[i].goalsId %>"><%= goals[i].goalsId %></a></td>
              <td><%= goals[i].goalDescription %></td>
              <td><%= goals[i].CarbonFootPrint %></td>
              <td><%= new Date(goals[i].goalStartDate).toLocaleDateString() %></td>
              <td><%= new Date(goals[i].goalEndDate).toLocaleDateString() %></td>
              <td>
                <select class="form-select goal-status" data-goal-id="<%= goals[i].goalsId %>">
                  <option value="not started" <%= goals[i].goalStatus === 'not started' ? 'selected' : '' %>>Not Started</option>
                  <option value="in progress" <%= goals[i].goalStatus === 'in progress' ? 'selected' : '' %>>In Progress</option>
                  <option value="completed" <%= goals[i].goalStatus === 'completed' ? 'selected' : '' %>>Completed</option>
                </select>
              </td>
              <td><a href="/goal/<%= goals[i].goalsId %>/edit" class="btn btn-primary btn-sm">Edit</a></td>
              <td><a href="/goal/<%= goals[i].goalsId %>/delete" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this goal?')">Delete</a></td>
            </tr>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>
</div>